// Generated by CoffeeScript 1.6.3
(function(){jQuery(function(){var e,t;t="ko en zh-CN zh-TW ja".split(" ");moment.lang("ko");$("div.datetimepicker").datetimepicker({format:"yyyy-MM-dd hh:mm:ss",language:"ko-KR"});e={};e.signin=function(e){var t,n,r;t=$(e);n=t.find("#input10").val().trim();r=t.find("#input11").val().trim();if(n.length===0){alert("이메일 주소를 입력해주세요.");return}if(r.length===0){alert("비밀번호를 입력해주세요.");return}return $.ajax({url:"/session",method:"post",data:{email:n,password:r},success:function(e,t,n){return e.code===200?location.href="/users/"+e.id:alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.signup=function(e){var t,n,r,i,s,o;t=$(e);n=t.find("#input20").val().trim();i=t.find("#input21").val().trim();s=t.find("#input22").val().trim();r=t.find("#input23").val().trim();o=t.find("#input24").val().trim();if(n.length===0||n.indexOf("@")===-1){alert("이메일 주소를 입력해주세요.");return}if(i.length===0){alert("비밀번호를 입력해주세요.");return}if(i!==s){alert("두 개의 비밀번호가 일치하지 않습니다.");return}if(r.length===0){alert("이름을 입력해주세요.");return}return $.ajax({url:"/users",method:"post",data:{email:n,password:i,name:r,promo:o},success:function(e,t,n){return e.code===200?location.href="/users/"+e.id:alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.createApp=function(e,t){var n,r;n=$(t.target);r=prompt("추가할 앱 이름을 적어주세요. (1글자 이상)");r=r.trim();if(r.length===0)return;return $.ajax({url:"/apps",method:"post",data:{name:r},success:function(e,t,n){return e.code===200?location.href="/apps/"+e.id:alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.updateApp=function(e){var t,n,r,i,s;t=$(e);r=t.data("app-id");i=t.find("#input20").val().trim();n=t.find("#input21").val().trim();s=t.find("#input23").val().trim();return $.ajax({url:"/apps/"+r,method:"put",data:{name:i,identifier:n,platform:s},success:function(e,n,r){return e.code===200?t.find("button[type=submit]").html(moment(e.timestamp).format("LT")+" 완료"):alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.createBoard=function(e,t){var n;n=prompt("추가할 게시판 이름을 적어주세요. (1글자 이상)");n=n.trim();if(n.length===0)return;return $.ajax({url:"/boards",method:"post",data:{name:n},success:function(e,t,n){return e.code===200?location.href="/boards/"+e.id:alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.updateBoard=function(e){var t,n,r,i,s,o;t=$(e);i=t.data("board-id");n=t.find("#input20").val().trim();s=t.find("#input21").val().trim();o=t.find("input[name=input22]:checked").val().trim();r=t.find("#input24").val().trim();return $.ajax({url:"/boards/"+i,method:"put",data:{name:s,appId:n,viewType:o,defaultLang:r},success:function(e,n,r){return e.code===200?t.find("button[type=submit]").html(moment(e.timestamp).format("LT")+" 완료"):alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.createPost=function(e,t){var n,r;n=$(t.target).data("board-id");r=$(t.target).data("board-default-lang");return $.ajax({url:"/boards/"+n+"/posts",method:"post",data:{subject:"제목없음",lang:r},success:function(e,t,r){return e.code===200?location.href="/boards/"+n+"/posts/"+e.id:alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.updatePost=function(e){var t,n,r,i,s,o,u,a;t=$(e);n=t.data("board-id");o=t.data("post-id");a=t.find("#input20").val().trim();r=t.find("#input21").val();i=t.find("#input22").val().trim();u=t.find("#input23").val();s=moment(u).format("YYYY-MM-DD hh:mm:ss");if(s==="Invalid date"){alert("게시일의 날짜 형식이 잘못되었습니다.\n\n바른 형식: "+moment().format("YYYY-MM-DD hh:mm:ss"));return}return $.ajax({url:"/boards/"+n+"/posts/"+o,method:"put",data:{subject:a,body:r,lang:i,publishAt:u},success:function(e,n,r){return e.code===200?t.find("button[type=submit]").html(moment(e.timestamp).format("LT")+" 완료"):alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.deletePost=function(e,t){var n,r,i;n=$(t.target);r=n.data("board-id");i=n.data("post-id");return $.ajax({url:"/boards/"+r+"/posts/"+i,method:"delete",success:function(e,t,n){var r;if(e.code===200){r=$("tr[data-post-id="+i+"]");r.css({opacity:.3});return r.find("a,button").remove()}return alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.previewPost=function(e,t){var n,r,i,s,o,u;r=$("iframe.preview");s=r.contents().find("content .list");i=s.find(".item-preview");n=s.find(".item-preview-content");u=$("#input20").val().trim();o=$("#input21").val();i.show();i.find(".item-preview-title").html(u);i.find(".item-preview-subtitle").html(moment().format("MM/DD"));return n.html(o)};e.viewBoard=function(e,t){var n,r;n=$(t.target);r=n.data("board-id");return location.href="/boards/"+r+"/preview"};e.createMessage=function(e,t){var n;n=prompt("메시지 이름을 적어주세요. (1글자 이상)");n=n.trim();if(n.length===0)return;return $.ajax({url:"/messages",method:"post",data:{name:n},success:function(e,t,n){return e.code===200?location.href="/messages/"+e.id:alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.updateMessage=function(e){var n,r,i,s,o,u,a,f,l,c;n=$(e);a=n.data("message-id");r=n.find("#input20").val().trim();f=n.find("#input21").val().trim();s=n.find("#input22").val().trim();u=n.find("#input24").val().trim();if(r==="0"){alert("연결된 앱이 없습니다. 앱을 선택해주세요.");n.find("#input20").focus();return}if(s.length===0){alert("식별자는 1글자 이상이어야 합니다.");n.find("#input22").focus();return}if(!/^[a-z0-9\-\_]+$/i.test(s)){alert("식별자 형식이 잘못되었습니다. URI 규칙을 따릅니다.");n.find("#input22").focus();return}i={appId:r,name:f,identifier:s,lang:u};for(l=0,c=t.length;l<c;l++){o=t[l];i[o]=$("#"+o).val()}return $.ajax({url:"/messages/"+a,method:"put",data:i,success:function(e,t,r){if(e.code===200){n.find("button[type=submit]").html(moment(e.timestamp).format("LT")+" 완료");return location.reload()}return alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.deleteMessage=function(e,t){var n,r;n=$(t.target);r=n.data("message-id");return $.ajax({url:"/messages/"+r,method:"delete",success:function(e,t,n){var i;if(e.code===200){i=$("tr[data-message-id="+r+"]");i.css({opacity:.3});return i.find("a,button").remove()}return alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};e.signBeta=function(e,t){var n,r;n=$(t.target);r=prompt("감사합니다 !\n\n이메일 주소를 남겨주시면 순차적으로 가입링크를 보내드리겠습니다.");if(r.length===0)return!1;if(r.indexOf("@")===-1){r=prompt("이메일 주소를 다시 확인해주세요.");if(r.length===0)return!1;if(r.indexOf("@")===-1)return!1}return $.ajax({url:"/users/subscribe",method:"post",data:{email:r},success:function(e,t,r){return e.code===200?n.html("곧 연락드리겠습니다. 감사합니다!"):alert(e.message+" "+e.code)},error:function(e,t,n){return alert("다시 시도해주세요.")}})};ko.applyBindings(e);return!0})}).call(this);